

services:
  web:
    # given build context
    build: 
      context: .
      dockerfile: Dockerfile
    image: scent-mart:v2
    container_name: scentmart-web
    # ports:    ISKO HATA DIYA 
    #   - "3000:3000"
    env_file:
      - .env.production
    expose: # internal only, ye port bahar (browser pe) expose nahi hoga! sirf NGINX access kar sakta hain!
      - "3000"
    restart: unless-stopped
  
  # nginx public facing hain!
  nginx:
    image: nginx:alpine
    container_name: scentmart-nginx
    ports:
      - "80:80"
    volumes:
      - ./nginx/default.conf:/etc/nginx/conf.d/default.conf
    depends_on:
      - web
    restart: unless-stopped



# ğŸ§  Samajh lo:
# service = ek container
# image = jo tu already build kar chuka
# container_name = random naam nahi aayega
# env_file = secrets safe way
# restart = crash ho toh auto start


# NGINX ka kaam:
# â€œUser se request lo, backend ko bhejo, response wapas doâ€

# So actual flow:
# Browser
#   â†“
# localhost:80
#   â†“
# NGINX
#   â†“
# scentmart-web:3000
#   â†“
# Next.js app 
